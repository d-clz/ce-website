{"remainingRequest":"/home/dclz/vivexelt-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/dclz/vivexelt-admin/src/views/Gallerys/List.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/dclz/vivexelt-admin/src/views/Gallerys/List.vue","mtime":1620438743778},{"path":"/home/dclz/vivexelt-admin/node_modules/cache-loader/dist/cjs.js","mtime":1620142631738},{"path":"/home/dclz/vivexelt-admin/node_modules/babel-loader/lib/index.js","mtime":1620325525308},{"path":"/home/dclz/vivexelt-admin/node_modules/cache-loader/dist/cjs.js","mtime":1620142631738},{"path":"/home/dclz/vivexelt-admin/node_modules/vue-loader/lib/index.js","mtime":1620325533304}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IFRhYmxlLCBUYWJsZUNvbHVtbiB9IGZyb20gJ2VsZW1lbnQtdWknCmltcG9ydCBnYWxsZXJ5U2VydmljZSBmcm9tICdAL2FwaS9nYWxsZXJ5U2VydmljZScKCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBbVGFibGUubmFtZV06IFRhYmxlLAogICAgW1RhYmxlQ29sdW1uLm5hbWVdOiBUYWJsZUNvbHVtbiwKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBnYWxsZXJ5czogW10sCiAgICAgIGlzTG9hZGluZzogZmFsc2UsCiAgICAgIGZpbHRlcjogewogICAgICAgIHBhZ2U6IDEsCiAgICAgICAgbGltaXQ6IDIsCiAgICAgICAgbmFtZTogJycsCiAgICAgIH0sCiAgICAgIGdhbGxlcnlTZWxlY3RlZDogW10sCiAgICAgIHZpc2libGVCdWxrQWN0aW9uOiBmYWxzZSwKICAgICAgdG90YWxHYWxsZXJ5OiAwLAogICAgICBjb25maXJtTW9kYWw6IHsKICAgICAgICBzaG93OiBmYWxzZSwKICAgICAgICBtZXNzYWdlOiAnJywKICAgICAgfSwKICAgICAgZW50aXR5SWQ6IDAsCiAgICAgIHVybDogcHJvY2Vzcy5lbnYuVlVFX0FQUF9CQVNFX0FQSV9FTkRQT0lOVCArICcvcHVibGljL2ltYWdlLycsCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBhc3luYyBpbml0KCkgewogICAgICBnYWxsZXJ5U2VydmljZS5nZXRBbGxHYWxsZXJ5KCkudGhlbigoZGF0YSkgPT4gewogICAgICAgIGlmICghZGF0YS5zdWNjZXNzKSByZXR1cm4KICAgICAgICB0aGlzLmdhbGxlcnlzID0gZGF0YS5nYWxsZXJ5cwogICAgICB9KQogICAgfSwKICAgIGNsb3NlQ29uZmlybU1vZGFsKCkgewogICAgICB0aGlzLmNvbmZpcm1Nb2RhbC5zaG93ID0gZmFsc2UKICAgICAgdGhpcy5jb25maXJtTW9kYWwubWVzc2FnZSA9ICcnCiAgICAgIHRoaXMuZW50aXR5SWQgPSAwCiAgICB9LAoKICAgIHRvZ2dsZUNvbmZpcm1Nb2RhbChpc011bHRpcGxlLCBpZCkgewogICAgICB0aGlzLmRlbGV0ZU1vZGUgPSBpc011bHRpcGxlID09PSB0cnVlID8gJ211bHRpcGxlJyA6ICdzaW5nbGUnCiAgICAgIGlmIChpZCkgewogICAgICAgIHRoaXMuZW50aXR5SWQgPSBpZAogICAgICB9CiAgICAgIHRoaXMuY29uZmlybU1vZGFsLnNob3cgPSB0cnVlCiAgICAgIGlmICh0aGlzLmRlbGV0ZU1vZGUgPT09ICdzaW5nbGUnKSB7CiAgICAgICAgdGhpcy5jb25maXJtTW9kYWwubWVzc2FnZSA9IGBEZWxldGUgdGhpcyBHYWxsZXJ5P2AKICAgICAgfSBlbHNlIHsKICAgICAgICBsZXQgbGVuZ3RoID0gdGhpcy5nYWxsZXJ5U2VsZWN0ZWQubGVuZ3RoCiAgICAgICAgbGV0IHRvdGFsID0gdGhpcy5nYWxsZXJ5cy5sZW5ndGgKICAgICAgICB0aGlzLmNvbmZpcm1Nb2RhbC5tZXNzYWdlID0gYERlbGV0ZSAke2xlbmd0aH0gb3V0IG9mICR7dG90YWx9P2AKICAgICAgfQogICAgfSwKCiAgICBhc3luYyBkb0RlbGV0ZSgpIHsKICAgICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlCiAgICAgIGxldCByZXMgPSB7fQogICAgICBpZiAodGhpcy5kZWxldGVNb2RlID09PSAnc2luZ2xlJykgewogICAgICAgIHJlcyA9IGF3YWl0IGdhbGxlcnlTZXJ2aWNlLmRlbGV0ZUdhbGxlcnlCeUlkKHRoaXMuZW50aXR5SWQpCiAgICAgICAgY29uc29sZS5sb2coJ3JlcycsIHJlcykKICAgICAgICBpZiAoIXJlcyB8fCAhcmVzLnN1Y2Nlc3MgfHwgcmVzLmVycm9yX21lc3NhZ2UpIHsKICAgICAgICAgIHRoaXMuJG5vdGlmeSh7CiAgICAgICAgICAgIHZlcnRpY2FsQWxpZ246ICdib3R0b20nLAogICAgICAgICAgICBob3Jpem9udGFsQWxpZ246ICdjZW50ZXInLAogICAgICAgICAgICB0eXBlOiAnZGFuZ2VyJywKICAgICAgICAgICAgbWVzc2FnZTogcmVzLmVycm9yX21lc3NhZ2UgfHwgJ1NvbWV0aGluZyB3ZW50IHdyb25nJywKICAgICAgICAgIH0pCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuJG5vdGlmeSh7CiAgICAgICAgICAgIHZlcnRpY2FsQWxpZ246ICdib3R0b20nLAogICAgICAgICAgICBob3Jpem9udGFsQWxpZ246ICdjZW50ZXInLAogICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgICAgIG1lc3NhZ2U6IGBEZWxldGUgam9iIHN1Y2Nlc3NmdWxseWAsCiAgICAgICAgICB9KQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmdhbGxlcnlTZWxlY3RlZC5mb3JFYWNoKChlKSA9PiB7CiAgICAgICAgICBnYWxsZXJ5U2VydmljZS5kZWxldGVHYWxsZXJ5QnlJZChlLmlkKS50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgaWYgKHJlcyAmJiByZXMuc3VjY2VzcykgewogICAgICAgICAgICAgIHRoaXMuJG5vdGlmeSh7CiAgICAgICAgICAgICAgICB2ZXJ0aWNhbEFsaWduOiAnYm90dG9tJywKICAgICAgICAgICAgICAgIGhvcml6b250YWxBbGlnbjogJ2NlbnRlcicsCiAgICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgICAgICAgICBtZXNzYWdlOiBgRGVsZXRlIGpvYiBzdWNjZXNzZnVsbHlgLAogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdGhpcy4kbm90aWZ5KHsKICAgICAgICAgICAgICAgIHZlcnRpY2FsQWxpZ246ICdib3R0b20nLAogICAgICAgICAgICAgICAgaG9yaXpvbnRhbEFsaWduOiAnY2VudGVyJywKICAgICAgICAgICAgICAgIHR5cGU6ICdkYW5nZXInLAogICAgICAgICAgICAgICAgbWVzc2FnZTogcmVzLmVycm9yX21lc3NhZ2UgfHwgJ1NvbWV0aGluZyB3ZW50IHdyb25nJywKICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgIH0pCiAgICAgIH0KICAgICAgYXdhaXQgdGhpcy5pbml0KCkKICAgICAgdGhpcy5nYWxsZXJ5U2VsZWN0ZWQgPSBbXQogICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlCiAgICAgIHRoaXMuY2xvc2VDb25maXJtTW9kYWwoKQogICAgfSwKCiAgICBjaGFuZ2VQYWdlKHZhbCkgewogICAgICB0aGlzLmZpbHRlci5wYWdlID0gdmFsCiAgICB9LAoKICAgIHNlbGVjdGlvbkNoYW5nZWQoc2VsZWN0aW9uKSB7CiAgICAgIHRoaXMuZ2FsbGVyeVNlbGVjdGVkID0gc2VsZWN0aW9uCiAgICB9LAogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuaW5pdCgpCiAgfSwKICB3YXRjaDogewogICAgZmlsdGVyOiB7CiAgICAgIGhhbmRsZXIodmFsKSB7CiAgICAgICAgdGhpcy5kZWJvdW5jZUZldGNoT3JkZXJzRGF0YSgpCiAgICAgIH0sCiAgICAgIGRlZXA6IHRydWUsCiAgICB9LAogICAgZ2FsbGVyeVNlbGVjdGVkOiB7CiAgICAgIGhhbmRsZXIoKSB7CiAgICAgICAgaWYgKHRoaXMuZ2FsbGVyeVNlbGVjdGVkICYmIHRoaXMuZ2FsbGVyeVNlbGVjdGVkLmxlbmd0aCA+IDApIHsKICAgICAgICAgIHRoaXMudmlzaWJsZUJ1bGtBY3Rpb24gPSB0cnVlCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMudmlzaWJsZUJ1bGtBY3Rpb24gPSBmYWxzZQogICAgICAgIH0KICAgICAgfSwKICAgICAgZGVlcDogdHJ1ZSwKICAgIH0sCiAgfSwKfQo="},{"version":3,"sources":["List.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmHA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"List.vue","sourceRoot":"src/views/Gallerys","sourcesContent":["<template>\n  <div>\n    <div v-if=\"isLoading\">\n      <base-header class=\"pb-6 pb-8 pt-5 pt-md-8 bg-gradient-blue\"> </base-header>\n      <b-container fluid class=\"mt--7\">\n        <card>\n          <dpmx-cl type=\"bullet\"></dpmx-cl>\n        </card>\n      </b-container>\n    </div>\n\n    <base-header class=\"pb-6 pb-8 pt-5 pt-md-8 bg-gradient-blue\" v-if=\"!isLoading\"> </base-header>\n\n    <b-container fluid class=\"mt--7\" v-if=\"!isLoading\">\n      <b-row>\n        <b-col>\n          <b-card no-body>\n            <b-card-header class=\"border-0\">\n              <b-input-group class>\n                <!-- <div class=\"input-group-prepend\">\n                  <span class=\"input-group-text\">\n                    <i class=\"fas fa-search\"></i>\n                  </span>\n                </div> -->\n                <!-- <b-form-input placeholder=\"Search\" type=\"text\" v-model=\"filter.name\"></b-form-input>\n                <b-input-group-append>\n                  <b-button v-b-toggle.collapse-1 variant=\"info\">More filters</b-button>\n                </b-input-group-append> -->\n              </b-input-group>\n              <b-collapse id=\"collapse-1\" class=\"mt-2\">\n                <b-card>\n                  <b-row> </b-row>\n                  <b-row class=\"pt-15\"> </b-row>\n                </b-card>\n              </b-collapse>\n              <b-collapse id=\"collapse-4\" v-model=\"visibleBulkAction\" class=\"mt-2\">\n                <span class=\"pr-15\">{{ gallerySelected.length }} selected</span>\n                <b-dropdown id=\"dropdown-1\" variant=\"secondary\" text=\"Action\" class=\"m-md-2\">\n                  <b-dropdown-item @click=\"toggleConfirmModal(true)\">Delete</b-dropdown-item>\n                </b-dropdown>\n              </b-collapse>\n            </b-card-header>\n            <el-table\n              class=\"table-responsive table dpxm-table\"\n              header-row-class-name=\"thead-light\"\n              :data=\"gallerys\"\n              @selection-change=\"selectionChanged\"\n            >\n              <el-table-column type=\"selection\" width=\"90\"></el-table-column>\n              <el-table-column label=\"Position\" min-width=\"100px\" prop=\"name\">\n                <template v-slot=\"{ row }\">\n                  <router-link :to=\"`/gallery/${row.id}`\">\n                    <b-media no-body class=\"align-items-center\">\n                      <b-media-body>\n                        <span class=\"font-weight-600 name mb-0 text-sm\">\n                          {{ row.position }}\n                        </span>\n                      </b-media-body>\n                    </b-media>\n                  </router-link>\n                </template>\n              </el-table-column>\n\n              <el-table-column label=\"Image\" prop=\"short_description\" min-width=\"300px\">\n                <template v-slot=\"{ row }\">\n                  <span class=\"font-16\">\n                    <img alt=\"Image placeholder\" :src=\"url + row.filename\" width=\"50px\" />\n                  </span>\n                </template>\n              </el-table-column>\n\n              <el-table-column label=\"Create At\" min-width=\"150px\" prop=\"status\">\n                <template v-slot=\"{ row }\">\n                  <span>{{ new Date(row.createAt).toISOString().split('T')[0] }}</span>\n                </template>\n              </el-table-column>\n\n              <el-table-column label=\"Action\" min-width=\"130px\">\n                <template v-slot=\"{ row }\">\n                  <base-button\n                    icon\n                    type=\"danger\"\n                    class=\"btn-sm\"\n                    @click=\"toggleConfirmModal(false, row.id)\"\n                    title=\"Delete\"\n                  >\n                    <i class=\"ni ni-fat-remove\"></i>\n                  </base-button>\n                </template>\n              </el-table-column>\n            </el-table>\n\n            <b-card-footer class=\"py-4 d-flex justify-content-end\">\n              <base-pagination\n                :per-page=\"filter.limit\"\n                :total=\"totalGallery\"\n                v-on:change=\"(val) => changePage(val)\"\n              ></base-pagination>\n            </b-card-footer>\n          </b-card>\n        </b-col>\n      </b-row>\n    </b-container>\n\n    <modal :show.sync=\"confirmModal.show\">\n      <h2>{{ this.confirmModal.message }}</h2>\n\n      <template slot=\"footer\">\n        <base-button type=\"link\" class=\"ml-auto\" @click=\"closeConfirmModal\">Close</base-button>\n        <base-button type=\"danger\" @click=\"doDelete\" :disabled=\"isLoading\">Delete</base-button>\n      </template>\n    </modal>\n  </div>\n</template>\n<script>\nimport { Table, TableColumn } from 'element-ui'\nimport galleryService from '@/api/galleryService'\n\nexport default {\n  components: {\n    [Table.name]: Table,\n    [TableColumn.name]: TableColumn,\n  },\n  data() {\n    return {\n      gallerys: [],\n      isLoading: false,\n      filter: {\n        page: 1,\n        limit: 2,\n        name: '',\n      },\n      gallerySelected: [],\n      visibleBulkAction: false,\n      totalGallery: 0,\n      confirmModal: {\n        show: false,\n        message: '',\n      },\n      entityId: 0,\n      url: process.env.VUE_APP_BASE_API_ENDPOINT + '/public/image/',\n    }\n  },\n  methods: {\n    async init() {\n      galleryService.getAllGallery().then((data) => {\n        if (!data.success) return\n        this.gallerys = data.gallerys\n      })\n    },\n    closeConfirmModal() {\n      this.confirmModal.show = false\n      this.confirmModal.message = ''\n      this.entityId = 0\n    },\n\n    toggleConfirmModal(isMultiple, id) {\n      this.deleteMode = isMultiple === true ? 'multiple' : 'single'\n      if (id) {\n        this.entityId = id\n      }\n      this.confirmModal.show = true\n      if (this.deleteMode === 'single') {\n        this.confirmModal.message = `Delete this Gallery?`\n      } else {\n        let length = this.gallerySelected.length\n        let total = this.gallerys.length\n        this.confirmModal.message = `Delete ${length} out of ${total}?`\n      }\n    },\n\n    async doDelete() {\n      this.isLoading = true\n      let res = {}\n      if (this.deleteMode === 'single') {\n        res = await galleryService.deleteGalleryById(this.entityId)\n        console.log('res', res)\n        if (!res || !res.success || res.error_message) {\n          this.$notify({\n            verticalAlign: 'bottom',\n            horizontalAlign: 'center',\n            type: 'danger',\n            message: res.error_message || 'Something went wrong',\n          })\n        } else {\n          this.$notify({\n            verticalAlign: 'bottom',\n            horizontalAlign: 'center',\n            type: 'success',\n            message: `Delete job successfully`,\n          })\n        }\n      } else {\n        this.gallerySelected.forEach((e) => {\n          galleryService.deleteGalleryById(e.id).then((res) => {\n            if (res && res.success) {\n              this.$notify({\n                verticalAlign: 'bottom',\n                horizontalAlign: 'center',\n                type: 'success',\n                message: `Delete job successfully`,\n              })\n            } else {\n              this.$notify({\n                verticalAlign: 'bottom',\n                horizontalAlign: 'center',\n                type: 'danger',\n                message: res.error_message || 'Something went wrong',\n              })\n            }\n          })\n        })\n      }\n      await this.init()\n      this.gallerySelected = []\n      this.isLoading = false\n      this.closeConfirmModal()\n    },\n\n    changePage(val) {\n      this.filter.page = val\n    },\n\n    selectionChanged(selection) {\n      this.gallerySelected = selection\n    },\n  },\n  mounted() {\n    this.init()\n  },\n  watch: {\n    filter: {\n      handler(val) {\n        this.debounceFetchOrdersData()\n      },\n      deep: true,\n    },\n    gallerySelected: {\n      handler() {\n        if (this.gallerySelected && this.gallerySelected.length > 0) {\n          this.visibleBulkAction = true\n        } else {\n          this.visibleBulkAction = false\n        }\n      },\n      deep: true,\n    },\n  },\n}\n</script>\n"]}]}