{"remainingRequest":"/home/dclz/vivexelt-admin/node_modules/babel-loader/lib/index.js!/home/dclz/vivexelt-admin/node_modules/eslint-loader/index.js??ref--13-0!/home/dclz/vivexelt-admin/src/core/helpers/localStorage.js","dependencies":[{"path":"/home/dclz/vivexelt-admin/src/core/helpers/localStorage.js","mtime":1620325383198},{"path":"/home/dclz/vivexelt-admin/node_modules/cache-loader/dist/cjs.js","mtime":1620142631738},{"path":"/home/dclz/vivexelt-admin/node_modules/babel-loader/lib/index.js","mtime":1620325525308},{"path":"/home/dclz/vivexelt-admin/node_modules/eslint-loader/index.js","mtime":1620142637801}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIi9ob21lL2RjbHovdml2ZXhlbHQtYWRtaW4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lLWNvcmVqczIvaGVscGVycy9lc20vc2xpY2VkVG9BcnJheSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzNy5vYmplY3QuZW50cmllcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20uaXRlcmFibGUiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lczYucmVnZXhwLnRvLXN0cmluZyI7CmltcG9ydCBhZGREYXlzIGZyb20gImRhdGUtZm5zL2FkZERheXMiOwppbXBvcnQgZ2V0VGltZSBmcm9tICJkYXRlLWZucy9nZXRUaW1lIjsKaW1wb3J0IHsgaXNFbXB0eSB9IGZyb20gIi4uL3V0aWxzL29iamVjdCI7CmltcG9ydCB7IERFRkFVTFRfU1RPUkFHRV9MSUZFX1RJTUUgfSBmcm9tICIuLi9jb25zdGFudHMvc3RvcmFnZSI7Ci8qKgogKiBBcHBlbmQgc3ViZml4IGV4cGlyZQogKiBAcGFyYW0ga2V5CiAqIEByZXR1cm5zIHtzdHJpbmd9CiAqLwoKdmFyIGdldEV4cGlyZUtleSA9IGZ1bmN0aW9uIGdldEV4cGlyZUtleShrZXkpIHsKICByZXR1cm4gIiIuY29uY2F0KGtleSwgIl9leHBpcmUiKTsKfTsKLyoqCiAqIFZlcmlmeSBsb2NhbHN0b3JhZ2Ugbm90IGV4cGlyZWQKICogQHBhcmFtIGtleQogKiBAcmV0dXJucyB7Ym9vbGVhbn0KICovCgoKdmFyIGlzTm90RXhwaXJlZCA9IGZ1bmN0aW9uIGlzTm90RXhwaXJlZChrZXkpIHsKICB2YXIgZXhwaXJlID0gcGFyc2VJbnQod2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKGdldEV4cGlyZUtleShrZXkpKSwgMTApOwogIHJldHVybiBleHBpcmUgJiYgZXhwaXJlID49IGdldFRpbWUoZ2V0VGltZShuZXcgRGF0ZSgpKSk7Cn07Cgp2YXIgTG9jYWxTdG9yYWdlID0gewogIC8qKgogICAqIFNldAogICAqIEBwYXJhbSBrZXkKICAgKiBAcGFyYW0gdmFsCiAgICogQHBhcmFtIGV4cGlyZXMKICAgKi8KICBzZXQ6IGZ1bmN0aW9uIHNldChrZXksIHZhbCkgewogICAgdmFyIGV4cGlyZXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IG51bGw7CiAgICB2YXIgZHVyYXRpb247CgogICAgaWYgKGV4cGlyZXMpIHsKICAgICAgZHVyYXRpb24gPSBuZXcgRGF0ZShleHBpcmVzKTsKICAgIH0gZWxzZSB7CiAgICAgIGR1cmF0aW9uID0gYWRkRGF5cyhuZXcgRGF0ZSgpLCBERUZBVUxUX1NUT1JBR0VfTElGRV9USU1FKTsKICAgIH0KCiAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCB2YWwpOwogICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKGdldEV4cGlyZUtleShrZXkpLCBkdXJhdGlvbi5nZXRUaW1lKCkudG9TdHJpbmcoKSk7CiAgfSwKCiAgLyoqCiAgICogR2V0CiAgICogQHBhcmFtIGtleQogICAqIEByZXR1cm4geyp9CiAgICovCiAgZ2V0OiBmdW5jdGlvbiBnZXQoa2V5KSB7CiAgICBpZiAoaXNOb3RFeHBpcmVkKGtleSkpIHsKICAgICAgcmV0dXJuIHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpOwogICAgfSBlbHNlIHsKICAgICAgTG9jYWxTdG9yYWdlLnJlbW92ZShrZXkpOwogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0sCgogIC8qKgogICAqIEdldCBhbGwKICAgKiBAcGFyYW0gY2FsbGJhY2sKICAgKiBAcmV0dXJuIHtBcnJheX0KICAgKi8KICBlYWNoOiBmdW5jdGlvbiBlYWNoKGNhbGxiYWNrKSB7CiAgICB2YXIgdmFsdWVzID0gd2luZG93LmxvY2FsU3RvcmFnZTsKCiAgICBpZiAodmFsdWVzICYmICFpc0VtcHR5KHZhbHVlcykpIHsKICAgICAgT2JqZWN0LmVudHJpZXModmFsdWVzKS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgdmFyIF9pdGVtID0gX3NsaWNlZFRvQXJyYXkoaXRlbSwgMiksCiAgICAgICAgICAgIGtleSA9IF9pdGVtWzBdLAogICAgICAgICAgICB2YWx1ZSA9IF9pdGVtWzFdOwoKICAgICAgICBjYWxsYmFjayhrZXksIHZhbHVlKTsKICAgICAgfSk7CiAgICB9CiAgfSwKCiAgLyoqCiAgICogUmVtb3ZlCiAgICogQHBhcmFtIGtleQogICAqLwogIHJlbW92ZTogZnVuY3Rpb24gcmVtb3ZlKGtleSkgewogICAgd2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7CiAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oZ2V0RXhwaXJlS2V5KGtleSkpOwogIH0sCgogIC8qKgogICAqIEhhcwogICAqIEBwYXJhbSBrZXkKICAgKiBAcmV0dXJuIHtib29sZWFufQogICAqLwogIGhhczogZnVuY3Rpb24gaGFzKGtleSkgewogICAgcmV0dXJuIExvY2FsU3RvcmFnZS5nZXQoa2V5KSAhPT0gbnVsbDsKICB9LAoKICAvKioKICAgKiBDbGVhciBhbGwKICAgKi8KICBjbGVhckFsbDogZnVuY3Rpb24gY2xlYXJBbGwoKSB7CiAgICBMb2NhbFN0b3JhZ2UuZWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgIExvY2FsU3RvcmFnZS5yZW1vdmUoa2V5KTsKICAgIH0pOwogIH0KfTsKZXhwb3J0IGRlZmF1bHQgTG9jYWxTdG9yYWdlOw=="},{"version":3,"sources":["/home/dclz/vivexelt-admin/src/core/helpers/localStorage.js"],"names":["addDays","getTime","isEmpty","DEFAULT_STORAGE_LIFE_TIME","getExpireKey","key","isNotExpired","expire","parseInt","window","localStorage","getItem","Date","LocalStorage","set","val","expires","duration","setItem","toString","get","remove","each","callback","values","Object","entries","forEach","item","value","removeItem","has","clearAll"],"mappings":";;;;AAAA,OAAOA,OAAP,MAAoB,kBAApB;AACA,OAAOC,OAAP,MAAoB,kBAApB;AACA,SAASC,OAAT;AACA,SAASC,yBAAT;AAEA;;;;;;AAKA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAAAC,GAAG;AAAA,mBAAOA,GAAP;AAAA,CAAxB;AAEA;;;;;;;AAKA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAAAD,GAAG,EAAI;AAC1B,MAAME,MAAM,GAAGC,QAAQ,CAACC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4BP,YAAY,CAACC,GAAD,CAAxC,CAAD,EAAiD,EAAjD,CAAvB;AACA,SAAOE,MAAM,IAAIA,MAAM,IAAIN,OAAO,CAACA,OAAO,CAAC,IAAIW,IAAJ,EAAD,CAAR,CAAlC;AACD,CAHD;;AAKA,IAAMC,YAAY,GAAG;AACnB;;;;;;AAMAC,EAAAA,GAPmB,eAOfT,GAPe,EAOVU,GAPU,EAOW;AAAA,QAAhBC,OAAgB,uEAAN,IAAM;AAC5B,QAAIC,QAAJ;;AAEA,QAAID,OAAJ,EAAa;AACXC,MAAAA,QAAQ,GAAG,IAAIL,IAAJ,CAASI,OAAT,CAAX;AACD,KAFD,MAEO;AACLC,MAAAA,QAAQ,GAAGjB,OAAO,CAAC,IAAIY,IAAJ,EAAD,EAAaT,yBAAb,CAAlB;AACD;;AAEDM,IAAAA,MAAM,CAACC,YAAP,CAAoBQ,OAApB,CAA4Bb,GAA5B,EAAiCU,GAAjC;AACAN,IAAAA,MAAM,CAACC,YAAP,CAAoBQ,OAApB,CACEd,YAAY,CAACC,GAAD,CADd,EAEEY,QAAQ,CAAChB,OAAT,GAAmBkB,QAAnB,EAFF;AAID,GArBkB;;AAuBnB;;;;;AAKAC,EAAAA,GA5BmB,eA4Bff,GA5Be,EA4BV;AACP,QAAIC,YAAY,CAACD,GAAD,CAAhB,EAAuB;AACrB,aAAOI,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4BN,GAA5B,CAAP;AACD,KAFD,MAEO;AACLQ,MAAAA,YAAY,CAACQ,MAAb,CAAoBhB,GAApB;AACD;;AAED,WAAO,IAAP;AACD,GApCkB;;AAsCnB;;;;;AAKAiB,EAAAA,IA3CmB,gBA2CdC,QA3Cc,EA2CJ;AACb,QAAMC,MAAM,GAAGf,MAAM,CAACC,YAAtB;;AAEA,QAAIc,MAAM,IAAI,CAACtB,OAAO,CAACsB,MAAD,CAAtB,EAAgC;AAC9BC,MAAAA,MAAM,CAACC,OAAP,CAAeF,MAAf,EAAuBG,OAAvB,CAA+B,UAAAC,IAAI,EAAI;AAAA,mCAChBA,IADgB;AAAA,YAC9BvB,GAD8B;AAAA,YACzBwB,KADyB;;AAErCN,QAAAA,QAAQ,CAAClB,GAAD,EAAMwB,KAAN,CAAR;AACD,OAHD;AAID;AACF,GApDkB;;AAsDnB;;;;AAIAR,EAAAA,MA1DmB,kBA0DZhB,GA1DY,EA0DP;AACVI,IAAAA,MAAM,CAACC,YAAP,CAAoBoB,UAApB,CAA+BzB,GAA/B;AACAI,IAAAA,MAAM,CAACC,YAAP,CAAoBoB,UAApB,CAA+B1B,YAAY,CAACC,GAAD,CAA3C;AACD,GA7DkB;;AA+DnB;;;;;AAKA0B,EAAAA,GApEmB,eAoEf1B,GApEe,EAoEV;AACP,WAAOQ,YAAY,CAACO,GAAb,CAAiBf,GAAjB,MAA0B,IAAjC;AACD,GAtEkB;;AAwEnB;;;AAGA2B,EAAAA,QA3EmB,sBA2ER;AACTnB,IAAAA,YAAY,CAACS,IAAb,CAAkB,UAAAjB,GAAG,EAAI;AACvBQ,MAAAA,YAAY,CAACQ,MAAb,CAAoBhB,GAApB;AACD,KAFD;AAGD;AA/EkB,CAArB;AAkFA,eAAeQ,YAAf","sourcesContent":["import addDays from \"date-fns/addDays\";\nimport getTime from \"date-fns/getTime\";\nimport { isEmpty } from \"../utils/object\";\nimport { DEFAULT_STORAGE_LIFE_TIME } from \"../constants/storage\";\n\n/**\n * Append subfix expire\n * @param key\n * @returns {string}\n */\nconst getExpireKey = key => `${key}_expire`;\n\n/**\n * Verify localstorage not expired\n * @param key\n * @returns {boolean}\n */\nconst isNotExpired = key => {\n  const expire = parseInt(window.localStorage.getItem(getExpireKey(key)), 10);\n  return expire && expire >= getTime(getTime(new Date()));\n};\n\nconst LocalStorage = {\n  /**\n   * Set\n   * @param key\n   * @param val\n   * @param expires\n   */\n  set(key, val, expires = null) {\n    let duration;\n\n    if (expires) {\n      duration = new Date(expires);\n    } else {\n      duration = addDays(new Date(), DEFAULT_STORAGE_LIFE_TIME);\n    }\n\n    window.localStorage.setItem(key, val);\n    window.localStorage.setItem(\n      getExpireKey(key),\n      duration.getTime().toString()\n    );\n  },\n\n  /**\n   * Get\n   * @param key\n   * @return {*}\n   */\n  get(key) {\n    if (isNotExpired(key)) {\n      return window.localStorage.getItem(key);\n    } else {\n      LocalStorage.remove(key);\n    }\n\n    return null;\n  },\n\n  /**\n   * Get all\n   * @param callback\n   * @return {Array}\n   */\n  each(callback) {\n    const values = window.localStorage;\n\n    if (values && !isEmpty(values)) {\n      Object.entries(values).forEach(item => {\n        const [key, value] = item;\n        callback(key, value);\n      });\n    }\n  },\n\n  /**\n   * Remove\n   * @param key\n   */\n  remove(key) {\n    window.localStorage.removeItem(key);\n    window.localStorage.removeItem(getExpireKey(key));\n  },\n\n  /**\n   * Has\n   * @param key\n   * @return {boolean}\n   */\n  has(key) {\n    return LocalStorage.get(key) !== null;\n  },\n\n  /**\n   * Clear all\n   */\n  clearAll() {\n    LocalStorage.each(key => {\n      LocalStorage.remove(key);\n    });\n  }\n};\n\nexport default LocalStorage;\n"]}]}